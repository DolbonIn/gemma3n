<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aura Kiosk Agent - Interactive Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Aura Calm Tech -->
    <!-- Application Structure Plan: A dual-panel, responsive layout to clearly demonstrate the cause-and-effect relationship between the user's simulated voice commands and the kiosk's reaction. The left panel represents the public kiosk UI, while the right panel simulates the user's private phone interface, showing their inputs and the agent's textual feedback. A single control button drives the pre-scripted scenario, ensuring a smooth, controllable flow ideal for a video demonstration. This structure was chosen to make the agent's value proposition immediately understandable: the user speaks to their phone, and the public kiosk responds accordingly. -->
    <!-- Visualization & Content Choices: The core "visualization" is the agent's decision-making process. This is shown through three elements: 1. Numbered bounding boxes overlaid on the kiosk UI to show what the agent "sees." 2. A simulated API call (using html2canvas to capture the UI) to represent the VLM analysis. 3. A temporary highlight on the chosen box to confirm the agent's action. The content is drawn from the user-provided `scenario` array, using HTML to render the kiosk and phone UIs. Library choices (Tailwind, html2canvas) directly support this interactive, visual demonstration without needing complex charting libraries. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans KR', 'Inter', sans-serif;
            background-color: #f0f2f5;
        }
        .phone-bubble-user {
            background-color: #3b82f6;
            color: white;
        }
        .phone-bubble-agent {
            background-color: #e5e7eb;
            color: #1f2937;
        }
        .highlight-box {
            transition: all 0.3s ease-in-out;
            box-shadow: 0 0 0 4px rgba(251, 191, 36, 0.8), 0 0 20px rgba(251, 191, 36, 0.5);
            transform: scale(1.05);
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="text-gray-800">

    <main class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800">Aura Kiosk Agent</h1>
            <p class="text-lg text-gray-500 mt-2">ìŒì„±ìœ¼ë¡œ ëª¨ë“  í‚¤ì˜¤ìŠ¤í¬ë¥¼ ì œì–´í•˜ëŠ” AI ì—ì´ì „íŠ¸ ë°ëª¨</p>
        </header>

        <div id="demo-container" class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            
            <!-- Kiosk Simulator -->
            <div id="kiosk-wrapper" class="lg:col-span-2 bg-gray-900 text-white rounded-2xl shadow-2xl p-6 flex flex-col items-center justify-center min-h-[60vh] md:min-h-[70vh]">
                <div class="w-full max-w-lg h-[50vh] md:h-[60vh] bg-black rounded-xl p-6 flex items-center justify-center relative">
                    <div id="kiosk-screen" class="w-full h-full text-center flex flex-col items-center justify-center transition-opacity duration-500">
                        <!-- Kiosk content will be injected here -->
                    </div>
                    <div id="kiosk-overlay" class="absolute top-0 left-0 w-full h-full p-6 pointer-events-none">
                        <!-- Bounding boxes will be injected here -->
                    </div>
                    <div id="loading-spinner" class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden"><div class="loader"></div></div>
                </div>
            </div>

            <!-- Phone & Control Simulator -->
            <div class="bg-white rounded-2xl shadow-lg p-6 flex flex-col">
                <div class="flex-grow mb-4">
                    <h2 class="text-2xl font-bold mb-4 border-b pb-2">ì‚¬ìš©ì ìŠ¤ë§ˆíŠ¸í°</h2>
                    <div id="phone-screen" class="h-96 overflow-y-auto p-4 bg-gray-50 rounded-lg flex flex-col-reverse">
                        <!-- Phone chat content will be injected here -->
                    </div>
                </div>
                <div>
                    <button id="next-step-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-6 rounded-lg text-xl transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-300">
                        ì‹œë‚˜ë¦¬ì˜¤ ì‹œì‘
                    </button>
                </div>
            </div>
        </div>
        
        <section class="mt-12 p-8 bg-white rounded-2xl shadow-lg">
            <h2 class="text-3xl font-bold mb-4">Aura ì—ì´ì „íŠ¸ ì‘ë™ ë°©ì‹</h2>
            <div class="text-gray-600 space-y-4">
                 <p>ì´ ë°ëª¨ëŠ” ì‚¬ìš©ìì˜ ìŒì„± ëª…ë ¹ì„ ë°›ì€ Aura ì—ì´ì „íŠ¸ê°€ í‚¤ì˜¤ìŠ¤í¬ í™”ë©´ì„ ì–´ë–»ê²Œ ì¸ì‹í•˜ê³ , ì–´ë–¤ í–‰ë™ì„ ê²°ì •í•˜ì—¬ ì‚¬ìš©ìë¥¼ ëŒ€ì‹ í•´ í‚¤ì˜¤ìŠ¤í¬ë¥¼ ì¡°ì‘í•˜ëŠ”ì§€ ë³´ì—¬ì¤ë‹ˆë‹¤. 'ë‹¤ìŒ ë‹¨ê³„' ë²„íŠ¼ì„ ëˆŒëŸ¬ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì§„í–‰í•˜ì„¸ìš”.</p>
                <ol class="list-decimal list-inside space-y-2">
                    <li><strong>ì‚¬ìš©ì ëª…ë ¹ ì¸ì‹:</strong> ì‚¬ìš©ìê°€ "ì£¼ë¬¸ ì‹œì‘í•´ì¤˜" ì™€ ê°™ì´ ìŒì„±ìœ¼ë¡œ ëª©í‘œë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.</li>
                    <li><strong>í™”ë©´ ë¶„ì„ (ìº¡ì²˜ & ì˜¤ë²„ë ˆì´):</strong> Aura ì—ì´ì „íŠ¸ê°€ í˜„ì¬ í‚¤ì˜¤ìŠ¤í¬ í™”ë©´ì„ ìº¡ì²˜í•˜ê³ , ìƒí˜¸ì‘ìš© ê°€ëŠ¥í•œ ëª¨ë“  ë²„íŠ¼ì— ë²ˆí˜¸ê°€ ë§¤ê²¨ì§„ ë°•ìŠ¤ë¥¼ ê·¸ë¦½ë‹ˆë‹¤.</li>
                    <li><strong>VLM ì¶”ë¡  (AIì˜ ê²°ì •):</strong> ìº¡ì²˜ëœ ì´ë¯¸ì§€ì™€ ì‚¬ìš©ì ëª©í‘œë¥¼ Gemma3n ëª¨ë¸ì— ì „ë‹¬í•˜ì—¬, ëª©í‘œ ë‹¬ì„±ì„ ìœ„í•´ ëˆŒëŸ¬ì•¼ í•  ë²„íŠ¼ì˜ ë²ˆí˜¸ë¥¼ ë°˜í™˜ë°›ìŠµë‹ˆë‹¤.</li>
                    <li><strong>ì•¡ì…˜ ìˆ˜í–‰ (í´ë¦­ & í•˜ì´ë¼ì´íŠ¸):</strong> ì—ì´ì „íŠ¸ëŠ” ëª¨ë¸ì´ ì„ íƒí•œ ë²ˆí˜¸ì˜ ë²„íŠ¼ì„ ìë™ìœ¼ë¡œ í´ë¦­í•©ë‹ˆë‹¤. ë°ëª¨ì—ì„œëŠ” ë…¸ë€ìƒ‰ í•˜ì´ë¼ì´íŠ¸ë¡œ ì´ ê³¼ì •ì„ ì‹œê°í™”í•©ë‹ˆë‹¤.</li>
                </ol>
            </div>
        </section>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const kioskScreen = document.getElementById('kiosk-screen');
            const kioskOverlay = document.getElementById('kiosk-overlay');
            const phoneScreen = document.getElementById('phone-screen');
            const nextStepBtn = document.getElementById('next-step-btn');
            const loadingSpinner = document.getElementById('loading-spinner');

            const scenarioData = [
                { // Step 0: Initial state
                    kioskHTML: `<h2 class="text-3xl font-bold mb-6">í„°ì¹˜í•˜ì—¬ ì£¼ë¬¸ ì‹œì‘</h2><p class="text-gray-400">Welcome</p>`,
                    phoneHTML: ``,
                    btnText: `ì‹œë‚˜ë¦¬ì˜¤ ì‹œì‘`,
                    subTask: "ì£¼ë¬¸ ì‹œì‘í•˜ê¸°",
                    boxes: [{ top: '0%', left: '0%', width: '100%', height: '100%' }],
                    agentActionId: 1
                },
                { // Step 1: Select Category
                    kioskHTML: `<h3 class="text-2xl font-bold mb-6">ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</h3><div class="grid grid-cols-3 gap-4 text-xl w-full"><div class="bg-gray-700 p-6 rounded-lg aspect-square flex items-center justify-center">â˜•ï¸<br>ì»¤í”¼</div><div class="bg-gray-600 p-6 rounded-lg aspect-square flex items-center justify-center">ğŸµ<br>í‹°</div><div class="bg-gray-600 p-6 rounded-lg aspect-square flex items-center justify-center">ğŸ°<br>ë””ì €íŠ¸</div></div>`,
                    phoneHTML: `<div class="w-full flex justify-end mb-2"><span class="phone-bubble-user p-3 rounded-lg inline-block max-w-xs">ì£¼ë¬¸ ì‹œì‘í•´ ì¤˜.</span></div><div class="w-full flex justify-start"><span class="phone-bubble-agent p-3 rounded-lg inline-block max-w-xs">ë„¤. í™”ë©´ì—ì„œ 'ì»¤í”¼', 'í‹°', 'ë””ì €íŠ¸' ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì–´ë–¤ ê²ƒì„ ì›í•˜ì‹œë‚˜ìš”?</span></div>`,
                    btnText: `ë‹¤ìŒ: "ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸ ì°¾ì•„ë´"`,
                    subTask: "ì»¤í”¼ ì¹´í…Œê³ ë¦¬ ì„ íƒí•˜ê¸°",
                    boxes: [
                        { top: '30%', left: '2%', width: '30%', height: '40%' }, 
                        { top: '30%', left: '35%', width: '30%', height: '40%' },
                        { top: '30%', left: '68%', width: '30%', height: '40%' }
                    ],
                    agentActionId: 1 
                },
                { // Step 2: Select Menu
                    kioskHTML: `<h3 class="text-2xl font-bold mb-4">ì»¤í”¼ ë©”ë‰´</h3><div class="grid grid-cols-2 gap-4 w-full mb-6"><div class="bg-gray-700 p-4 rounded-lg">ğŸ§Š ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸<br>4,500ì›</div><div class="bg-gray-600 p-4 rounded-lg">â˜•ï¸ ë”°ëœ»í•œ ë¼ë–¼<br>5,000ì›</div></div><h4 class="font-bold">ì‚¬ì´ì¦ˆ ì„ íƒ</h4><div class="flex justify-center gap-4 mt-2 w-full"><div class="border-2 border-gray-500 px-6 py-2 rounded-lg">ë ˆê·¤ëŸ¬</div><div class="border-2 border-gray-500 px-6 py-2 rounded-lg">ë¼ì§€</div></div>`,
                    phoneHTML: `<div class="w-full flex justify-end mb-2"><span class="phone-bubble-user p-3 rounded-lg inline-block max-w-xs">ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸ ì°¾ì•„ë´.</span></div><div class="w-full flex justify-start"><span class="phone-bubble-agent p-3 rounded-lg inline-block max-w-xs">'ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸'ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤. ì‚¬ì´ì¦ˆëŠ” 'ë ˆê·¤ëŸ¬'ì™€ 'ë¼ì§€'ê°€ ìˆìŠµë‹ˆë‹¤.</span></div>`,
                    btnText: `ë‹¤ìŒ: "ë¼ì§€ë¡œ í•˜ê³ , ì¥ë°”êµ¬ë‹ˆì— ë‹´ì•„ì¤˜"`,
                    subTask: "ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸ ì„ íƒ í›„ ë¼ì§€ ì‚¬ì´ì¦ˆ ì„ íƒí•˜ê¸°",
                    boxes: [
                        { top: '20%', left: '2%', width: '47%', height: '30%' }, // ì•„ì•„
                        { top: '20%', left: '51%', width: '47%', height: '30%' }, // ë¼ë–¼
                        { top: '65%', left: '15%', width: '30%', height: '15%' },// ë ˆê·¤ëŸ¬
                        { top: '65%', left: '55%', width: '30%', height: '15%' } // ë¼ì§€
                    ],
                    agentActionId: 4 // This implies a two-step action, but for the demo, we'll just click 'Large'
                },
                { // Step 3: Cart
                    kioskHTML: `<h3 class="text-2xl font-bold mb-6">ì¥ë°”êµ¬ë‹ˆ</h3><div class="bg-gray-700 p-4 rounded-lg text-left w-full">ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸ (ë¼ì§€) - 5,000ì›</div><div class="mt-8 text-2xl">ì´ ê¸ˆì•¡: 5,000ì›</div><div class="absolute bottom-6 w-11/12"><div class="bg-green-600 p-4 rounded-lg text-xl font-bold">ê²°ì œí•˜ê¸°</div></div>`,
                    phoneHTML: `<div class="w-full flex justify-end mb-2"><span class="phone-bubble-user p-3 rounded-lg inline-block max-w-xs">ë¼ì§€ë¡œ í•˜ê³ , ì¥ë°”êµ¬ë‹ˆì— ë‹´ì•„ì¤˜.</span></div><div class="w-full flex justify-start"><span class="phone-bubble-agent p-3 rounded-lg inline-block max-w-xs">ë¼ì§€ ì‚¬ì´ì¦ˆ ì•„ì´ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸ë¥¼ ì¥ë°”êµ¬ë‹ˆì— ë‹´ì•˜ìŠµë‹ˆë‹¤. ì´ 5,000ì›ì…ë‹ˆë‹¤. ê²°ì œí• ê¹Œìš”?</span></div>`,
                    btnText: `ë‹¤ìŒ: "ì‘, ê²°ì œí•´ ì¤˜"`,
                    subTask: "ê²°ì œí•˜ê¸° ë²„íŠ¼ ëˆ„ë¥´ê¸°",
                    boxes: [{ top: '80%', left: '4%', width: '92%', height: '15%' }],
                    agentActionId: 1
                },
                { // Step 4: Payment
                    kioskHTML: `<h3 class="text-2xl font-bold mb-6">ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ</h3><div class="grid grid-cols-2 gap-4 text-xl w-full"><div class="bg-gray-600 p-8 rounded-lg aspect-square flex items-center justify-center">ğŸ’³<br>ì‹ ìš©ì¹´ë“œ</div><div class="bg-gray-600 p-8 rounded-lg aspect-square flex items-center justify-center">ğŸ“±<br>ëª¨ë°”ì¼ í˜ì´</div></div>`,
                    phoneHTML: `<div class="w-full flex justify-end mb-2"><span class="phone-bubble-user p-3 rounded-lg inline-block max-w-xs">ì‘, ê²°ì œí•´ ì¤˜.</span></div><div class="w-full flex justify-start"><span class="phone-bubble-agent p-3 rounded-lg inline-block max-w-xs">ê²°ì œ í™”ë©´ìœ¼ë¡œ ì´ë™í–ˆìŠµë‹ˆë‹¤. ê²°ì œ ìˆ˜ë‹¨ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</span></div>`,
                    btnText: `ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°`,
                    subTask: "ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ ëŒ€ê¸°",
                    boxes: [
                        { top: '30%', left: '5%', width: '42%', height: '50%' },
                        { top: '30%', left: '53%', width: '42%', height: '50%' }
                    ],
                    agentActionId: null // No action, end of scenario
                },
            ];

            let currentStep = 0;

            function updateUI() {
                if (currentStep >= scenarioData.length) {
                    currentStep = 0;
                }
                
                const step = scenarioData[currentStep];
                
                kioskScreen.style.opacity = '0';
                phoneScreen.style.opacity = '0';

                setTimeout(() => {
                    kioskScreen.innerHTML = step.kioskHTML;
                    // Add new chat content to the top
                    const newPhoneContent = document.createElement('div');
                    newPhoneContent.innerHTML = step.phoneHTML;
                    if(phoneScreen.firstChild) {
                        phoneScreen.insertBefore(newPhoneContent, phoneScreen.firstChild);
                    } else {
                        phoneScreen.appendChild(newPhoneContent);
                    }
                    
                    nextStepBtn.textContent = step.btnText;
                    kioskScreen.style.opacity = '1';
                    phoneScreen.style.opacity = '1';
                }, 500);

                 // Clear previous boxes and draw new ones
                kioskOverlay.innerHTML = '';
                 setTimeout(() => { // Draw boxes after kiosk content has rendered
                    if (step.boxes) {
                        step.boxes.forEach((box, index) => {
                            const boxDiv = document.createElement('div');
                            boxDiv.id = `box-${index + 1}`;
                            boxDiv.className = 'absolute border-2 border-green-400 rounded-lg flex justify-start items-start transition-all duration-300';
                            boxDiv.style.top = box.top;
                            boxDiv.style.left = box.left;
                            boxDiv.style.width = box.width;
                            boxDiv.style.height = box.height;
                            boxDiv.innerHTML = `<span class="bg-green-400 text-white font-bold px-2 py-1 text-sm rounded-br-lg rounded-tl-lg">${index + 1}</span>`;
                            kioskOverlay.appendChild(boxDiv);
                        });
                    }
                }, 600);
            }
            
            async function mockApiCall() {
                loadingSpinner.classList.remove('hidden');
                nextStepBtn.disabled = true;

                // 1. Capture the screen using html2canvas
                const canvas = await html2canvas(kioskScreen.parentElement, {
                     backgroundColor: '#000',
                     logging: false,
                     useCORS: true
                });
                const imageBase64 = canvas.toDataURL('image/jpeg');

                // 2. Simulate the backend call and VLM logic
                console.log(`--- Step ${currentStep} ---`);
                console.log("Sub Task:", scenarioData[currentStep].subTask);
                console.log("Sending image to mock VLM...");
                // In a real app, this would be a fetch() call to the Python backend:
                // fetch('/interact', { method: 'POST', body: JSON.stringify({ image: imageBase64, ... }) })
                
                return new Promise(resolve => {
                    setTimeout(() => {
                        const agentActionId = scenarioData[currentStep].agentActionId;
                        const response = {
                            thought: `Based on the sub-task '${scenarioData[currentStep].subTask}', element ${agentActionId} is the most logical choice.`,
                            element_id: agentActionId
                        };
                        console.log("Mock VLM Response:", response);
                        resolve(response);
                    }, 1500 + Math.random() * 1000); // Simulate network and inference latency
                });
            }

            async function advanceScenario() {
                if (currentStep === 0) {
                     phoneScreen.innerHTML = ''; // Clear chat history at the start
                }
                updateUI();
                
                const stepData = scenarioData[currentStep];
                
                if (stepData.agentActionId !== null) {
                    const result = await mockApiCall();
                    
                    if (result && result.element_id) {
                        const targetBox = document.getElementById(`box-${result.element_id}`);
                        if (targetBox) {
                            targetBox.classList.add('highlight-box');
                            setTimeout(() => {
                                targetBox.classList.remove('highlight-box');
                            }, 2000);
                        }
                    }
                }
                
                loadingSpinner.classList.add('hidden');
                nextStepBtn.disabled = false;
                currentStep++;
            }

            nextStepBtn.addEventListener('click', advanceScenario);

            // Initial state
            updateUI();
        });
    </script>

</body>
</html>
